{"version":3,"sources":["../../../app-src/domain/negociacao/NegociacaoService.js"],"names":["HttpService","Negociacao","ApplicationException","NegociacaoService","constructor","_http","obterNegociacoesDaSemana","get","then","dados","map","objeto","Date","data","quantidade","valor","err","obtemNegociacoesDaSemanaAnterior","obtemNegociacoesDaSemanaRetrasada","obtemNegociacoesDoPeriodo","periodo","Promise","all","reduce","novoArray","item","concat","sort","a","b","getTime","console","log"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,iB,sBAAAA,W;;AACAC,gB,iBAAAA,U;;AACAC,0B,+BAAAA,oB;;;AAEF,YAAMC,iBAAN,CAAwB;;AAE7BC,sBAAc;AACZ,eAAKC,KAAL,GAAa,IAAIL,WAAJ,EAAb;AACD;;AAEDM,mCAA2B;;AAEzB,iBAAO,KAAKD,KAAL,CACJE,GADI,CACA,oBADA,EAEJC,IAFI,CAGHC,SACEA,MAAMC,GAAN,CAAUC,UACT,IAAIV,UAAJ,CAAe,IAAIW,IAAJ,CAASD,OAAOE,IAAhB,CAAf,EAAsCF,OAAOG,UAA7C,EAAyDH,OAAOI,KAAhE,CADD,CAJC,EAMHC,OAAO;AACL,kBAAM,IAAId,oBAAJ,CAAyB,wCAAzB,CAAN;AACD,WARE,CAAP;AAUD;;AAEDe,2CAAmC;AACjC,iBAAO,KAAKZ,KAAL,CACJE,GADI,CACA,sBADA,EAEJC,IAFI,CAGHC,SACEA,MAAMC,GAAN,CAAUC,UACT,IAAIV,UAAJ,CAAe,IAAIW,IAAJ,CAASD,OAAOE,IAAhB,CAAf,EAAsCF,OAAOG,UAA7C,EAAyDH,OAAOI,KAAhE,CADD,CAJC,EAMHC,OAAO;AACL,kBAAM,IAAId,oBAAJ,CAAyB,0DAAzB,CAAN;AACD,WARE,CAAP;AAUD;;AAEDgB,4CAAoC;AAClC,iBAAO,KAAKb,KAAL,CACJE,GADI,CACA,uBADA,EAEJC,IAFI,CAGHC,SACEA,MAAMC,GAAN,CAAUC,UACT,IAAIV,UAAJ,CAAe,IAAIW,IAAJ,CAASD,OAAOE,IAAhB,CAAf,EAAsCF,OAAOG,UAA7C,EAAyDH,OAAOI,KAAhE,CADD,CAJC,EAMHC,OAAO;AACL,kBAAM,IAAId,oBAAJ,CAAyB,4DAAzB,CAAN;AACD,WARE,CAAP;AAUD;;AAEKiB,iCAAN,GAAkC;AAAA;;AAAA;;AAEhC,gBAAI;AACF,kBAAIC,UAAU,MAAMC,QAAQC,GAAR,CAAY,CAC5B,MAAKhB,wBAAL,EAD4B,EAE5B,MAAKW,gCAAL,EAF4B,EAG5B,MAAKC,iCAAL,EAH4B,CAAZ,CAApB;AAKF,qBAAOE,QACJG,MADI,CACG,UAACC,SAAD,EAAYC,IAAZ;AAAA,uBAAqBD,UAAUE,MAAV,CAAiBD,IAAjB,CAArB;AAAA,eADH,EACgD,EADhD,EAEJE,IAFI,CAEC,UAACC,CAAD,EAAIC,CAAJ;AAAA,uBAAUA,EAAEhB,IAAF,CAAOiB,OAAP,KAAmBF,EAAEf,IAAF,CAAOiB,OAAP,EAA7B;AAAA,eAFD,CAAP;AAGC,aATD,CASE,OAAMd,GAAN,EAAW;AACXe,sBAAQC,GAAR,CAAYhB,GAAZ;AACA,oBAAM,IAAId,oBAAJ,CAAyB,mDAAzB,CAAN;AACD;AAd+B;AAejC;AA7D4B","file":"NegociacaoService.js","sourcesContent":["import { HttpService } from '../../util/HttpService.js';\r\nimport { Negociacao } from './Negociacao.js';\r\nimport { ApplicationException } from '../../util/ApplicationException.js'\r\n\r\nexport class NegociacaoService {\r\n\r\n  constructor() {\r\n    this._http = new HttpService();\r\n  }\r\n  \r\n  obterNegociacoesDaSemana() {\r\n\r\n    return this._http\r\n      .get('negociacoes/semana')\r\n      .then(\r\n        dados => \r\n          dados.map(objeto =>\r\n           new Negociacao(new Date(objeto.data), objeto.quantidade, objeto.valor)),\r\n        err => {\r\n          throw new ApplicationException('Não foi possível obter as negoociações');\r\n        }\r\n      );\r\n  }\r\n\r\n  obtemNegociacoesDaSemanaAnterior() {\r\n    return this._http\r\n      .get('negociacoes/anterior')\r\n      .then(\r\n        dados => \r\n          dados.map(objeto =>\r\n           new Negociacao(new Date(objeto.data), objeto.quantidade, objeto.valor)),\r\n        err => {\r\n          throw new ApplicationException('Não foi possível obter as negociações da semana anterior');\r\n        }\r\n      );\r\n  }\r\n\r\n  obtemNegociacoesDaSemanaRetrasada() {\r\n    return this._http\r\n      .get('negociacoes/retrasada')\r\n      .then(\r\n        dados =>\r\n          dados.map(objeto =>\r\n           new Negociacao(new Date(objeto.data), objeto.quantidade, objeto.valor)),\r\n        err => {\r\n          throw new ApplicationException('Não foi possível obter as negociações da semana retrasada.');\r\n        }\r\n      );\r\n  } \r\n  \r\n  async obtemNegociacoesDoPeriodo() {\r\n\r\n    try {\r\n      let periodo = await Promise.all([\r\n          this.obterNegociacoesDaSemana(),\r\n          this.obtemNegociacoesDaSemanaAnterior(),\r\n          this.obtemNegociacoesDaSemanaRetrasada()\r\n    ]);\r\n    return periodo\r\n      .reduce((novoArray, item) => novoArray.concat(item), [])\r\n      .sort((a, b) => b.data.getTime() - a.data.getTime());\r\n    } catch(err) {\r\n      console.log(err);\r\n      throw new ApplicationException('Não foi possível obter as negociações do período.')\r\n    };\r\n  }\r\n}"]}